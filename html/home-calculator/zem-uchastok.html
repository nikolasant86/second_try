<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Земельный участок</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Навигация -->
<nav>
  <a href="main.html">Главная</a>
  <a href="home-calculator.html">Калькулятор затрат</a>
  <a href="zem-uchastok.html">Земельный участок</a>
</nav>

<h1>Земельный участок</h1>

<!-- Фото галерея -->
<div class="gallery">
  <img src="images/01.jpg" alt="Фото 1" />
  <img src="images/02.jpg" alt="Фото 2" />
  <img src="images/03.jpg" alt="Фото 3" />
  <img src="images/04.jpg" alt="Фото 4" />
  <img src="images/05.jpg" alt="Фото 5" />
  <img src="images/06.jpg" alt="Фото 6" />
  <img src="images/07.jpg" alt="Фото 7" />
  <img src="images/08.jpg" alt="Фото 8" />
  <img src="images/09.jpg" alt="Фото 9" />
  <img src="images/10.jpg" alt="Фото 10" />
  <!-- добавьте свои фотографии по необходимости -->
</div>

<!-- Модальное окно для увеличения изображений -->
<div id="myModal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="fullImage" />
</div>

<!-- Скрипт (можете подключить отдельно в scripts.js) -->
<!--
<script src="scripts.js"></script>
-->

<script>
const images = [
  "images/01.jpg",
  "images/02.jpg",
  "images/03.jpg",
  "images/04.jpg",
  "images/05.jpg",
  "images/06.jpg",
  "images/07.jpg",
  "images/08.jpg",
  "images/09.jpg",
  "images/10.jpg"
];

let currentIndex = 0;

const modal = document.getElementById("myModal");
const modalImg = document.getElementById("fullImage");
const closeBtn = document.getElementsByClassName("close")[0];

document.querySelectorAll('.gallery img').forEach((img, index) => {
  img.onclick = () => {
    currentIndex = index;
    fetchImage(currentIndex);
    modal.style.display = "block";
  };
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (event) => {
  if (event.target == modal) {
    modal.style.display = "none";
  }
};

// Клавиши для перелистывания
document.onkeydown = (e) => {
  if (modal.style.display === "block") {
    if (e.key === "ArrowRight") {
      currentIndex = (currentIndex + 1) % images.length;
      fetchImage(currentIndex);
    } else if (e.key === "ArrowLeft") {
      currentIndex = (currentIndex - 1 + images.length) % images.length;
      fetchImage(currentIndex);
    }
  }
};

fetch('http://localhost:8000/api/images')
  .then(res => res.json())
  .then(data => {
    // data.images — массив имён файлов
    // Можно динамически сформировать галерею
  });

function fetchImage(index) {
  fetch(`http://localhost:8000/api/image/${index}`, { method: 'GET' })
    .then(res => {
      if (res.ok) return res.blob();
      throw new Error(`Ошибка загрузки изображения: ${res.status}`);
    })
    .then(blob => {
      const url = URL.createObjectURL(blob);
      console.log('Создан URL:', url);
      modalImg.src = url;
      console.log('Установлено src:', modalImg.src);
    })
    .catch(error => {
      alert(error.message);
      modal.style.display = "none";
    });
}

</script>

</body>
</html>
